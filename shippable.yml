build_image: phpdocker/phpdocker:7.0

language: php
php: 7.0

env:
  global:
    - TESTING=true

before_install:
  # Run daemons
  - service mysql start

  # Check environment
  - php -v
  - mysql -V
  - composer -V

install:
  # Database
  - mysql -e 'create database test;'

  # Composer
  - composer install --no-interaction --prefer-dist

before_script:
  # Prepare config files
  - touch tests/php.ini
  - cp tests/dbals.sample.ini tests/dbals.ini
  - cp tests/drivers.sample.ini tests/drivers.ini

script:
  # Run PHP CodeSniffer
  - vendor/bin/phpcs --standard=vendor/etten/codestyle/Etten/ruleset.xml -nsp src tests

  # Run Nette\Testser
  - tests/run.sh tests/cases
